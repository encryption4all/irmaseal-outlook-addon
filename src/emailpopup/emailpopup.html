<!-- Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license. See full license in root of repo. -->
<!-- This file shows how to create an empty HTML file to load an AAD login script. -->

<!DOCTYPE html>
<html>
  <head>
    <title>Email message popup</title>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />

    <!-- Office JavaScript API -->
    <script
      type="text/javascript"
      src="https://ajax.microsoft.com/ajax/4.0/MicrosoftAjax.js"
    ></script>
    <script
      type="text/javascript"
      src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.debug.js"
    ></script>

    <script>
      Office.initialize = function () {
        console.log('Emailpopup: init')
        Office.context.ui.addHandlerAsync(
          Office.EventType.DialogParentMessageReceived,
          onMessageFromParent,
          onRegisterMessageComplete
        )
      }

      function onRegisterMessageComplete(asyncResult) {
        if (asyncResult.status !== Office.AsyncResultStatus.Succeeded) {
          console.log('Emailpopup error: ', asyncResult.error.message)
        } else {
          console.log('Emailpopup registering complete ')
        }
      }

      function onMessageFromParent(arg) {
        console.log('Emailcontent: ', arg.message)
        document.getElementById('email').innerHTML = arg.message
      }
    </script>
  </head>

  <body>
    <div id="email"></div>
  </body>
</html>
